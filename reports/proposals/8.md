# Payloads

- [Network: Ethereum, PayloadsController: 0xdAbad81aF85554E9ae636395611C58F7eC1aAEc5, ID: 48](/reports/payloads/1/0xdAbad81aF85554E9ae636395611C58F7eC1aAEc5/48.md)

## Proposal 8

- Simulation: [https://dashboard.tenderly.co/me/simulator/87cdc7c4-b183-499c-ac36-e94a0f2eb4ef](https://dashboard.tenderly.co/me/simulator/87cdc7c4-b183-499c-ac36-e94a0f2eb4ef)
- state: Created
- creator: 0x99C7A4A4Ab99882C422eF777b182eBda204D5B02
- maximumAccessLevelRequired: 1
- payloads: [{"chain":"1","accessLevel":1,"payloadsController":"0xdAbad81aF85554E9ae636395611C58F7eC1aAEc5","payloadId":48}]
- createdAt: [24/01/2024, 13:21:59](https://etherscan.io/tx/0x911fc8cf98304a3c93c67742f6e86350994eeb83e7ddb5b57285619ba92e62cf)

### Ipfs

<details>
  <summary>Proposal text</summary>
  
  
## Simple Summary

This AIP proposes the deployment of the GHO Stability Module (GSM), a system facilitating the conversion between GHO and two governance-accepted stablecoins, USDC and USDT, at a predetermined ratio.

The GSM has undergone thorough iterations of design, development, testing, and implementation with Aave Labs driving this process and actively seeking community feedback. Additionally, the security aspect was carefully addressed through collaboration with DAO service providers SigmaPrime and Certora for code reviews. Furthermore, an extra layer of security was added by commissioning an independent review from a security researcher (Emanuele Ricci [@stermi](https://governance.aave.com/u/stermi/summary)).

Following extensive community discussion and multiple phases of Aave DAO governance, this AIP suggests deploying two GSM contracts for seamless conversions between GHO and USDC as well as GHO and USDT.

## Motivation

The GHO Stability Module (GSM) is a contract designed to facilitate conversions between two tokens with its primary purpose being to help further maintain GHO's peg. The module allows swaps between GHO and other governance-accepted stablecoins, offering a variety of functionalities that make it paramount in the fields of security and risk management.

Summarizing the functionality offered by the GHO Stability Module (GSM), here is a list of these features and their planned implementation for this proposal:

- **Exposure Cap**: Denominated in token units, it limits exposure to the exogenous asset.
- **Price Strategies**: Utilizing a fixed price strategy with a 1:1 ratio for stablecoins.
- **Fee Strategies**: Employing a flat basis point (bps) approach, differentiated by direction (sell/buy).
- **Last Resort Liquidation**: Aave DAO is the exclusive entity granted with the role of last resort liquidation, empowering it to take control of GSM funds in worst-case scenarios.
- **Swap Freeze**: Aave DAO and a chainlink-automated keeper contract have the authority to freeze the swap functionality. The chainlink-automated keeper contract bases its actions on the price of the exogenous asset, freezing if the price is outside the range and unfreezing if inside the range.
- **Capital Allocation**: Supporting this feature by allowing ERC4626 assets as underlying assets. This enables redirecting the yield generated by the ERC4626 asset, while residing in the GSM contract, to the GHO Treasury.

## Specification

The proposed payload entails the comprehensive activation of GSM USDC and GSM USDT, involving the following steps:

1. Incorporate GSM USDC and GSM USDT as facilitators of the GHO Token on Ethereum.
2. Adjust the Fee Strategy for both GSMs to implement a 0.2% flat fee for both directions (buy/sell).
3. Add both GSMs to the GSM Registry.
4. Designate OracleSwapFreezer contracts and Aave DAO as SwapFreezer entities in each GSM contract, respectively.
5. Activate these OracleSwapFreezer contracts as keepers of the Aave DAO through AaveRobot with a funding of 80 LINK for each.

The table below outlines the initially proposed risk parameters for each GSM contract, as approved through the snapshot:

**GSM USDC**

| Parameter                                | Value           |
| ---------------------------------------- | --------------- |
| Underlying Price Range for Swap Freeze   | [0.99 - 1.01]   |
| Underlying Price Range for Swap Unfreeze | [0.995 - 1.005] |
| Buy Fee                                  | 0.2%            |
| Sell Fee                                 | 0.2%            |
| Exposure Cap                             | 500,000 USDC    |
| Facilitator Bucket Capacity              | 500,000 GHO     |
| Swap Active                              | True            |

**GSM USDT**

| Parameter                                | Value           |
| ---------------------------------------- | --------------- |
| Underlying Price Range for Swap Freeze   | [0.99 - 1.01]   |
| Underlying Price Range for Swap Unfreeze | [0.995 - 1.005] |
| Buy Fee                                  | 0.2%            |
| Sell Fee                                 | 0.2%            |
| Exposure Cap                             | 500,000 USDT    |
| Facilitator Bucket Capacity              | 500,000 GHO     |
| Swap Active                              | True            |

## References

- Implementation: [Gho](https://github.com/bgd-labs/aave-proposals-v3/blob/805130c7b383084accaf4aaa29ffeb4c3a3c53e7/src/20240119_Gho_GHOStabilityModule/Gho_GHOStabilityModule_20240119.sol)
- Tests: [Gho](https://github.com/bgd-labs/aave-proposals-v3/blob/805130c7b383084accaf4aaa29ffeb4c3a3c53e7/src/20240119_Gho_GHOStabilityModule/Gho_GHOStabilityModule_20240119.t.sol)
- [Snapshot](https://snapshot.org/#/aave.eth/proposal/0xe9b62e197a98832da7d1231442b5960588747f184415fba4699b6325d7618842)
- [Discussion](https://governance.aave.com/t/gho-stability-module-update/14442)
- [GSM Repository](https://github.com/aave/gho-core/tree/main/src/contracts/facilitators/gsm)
- [GSM Audit Reports](https://github.com/aave/gho-core/tree/main/audits)

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).

</details>

### Check: Reports all state changes :white_check_mark:

#### Info


TransparentUpgradeableProxy at `0x9AEE0B04504CeF83A65AC3f0e838D0593BCb2BC7`[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.GOVERNANCE") with implementation Governance at `0x58BcB647C4beFf253B4B6996c62F737B783f2cDd`
```diff
@@ `_proposals` key `"8"`.state @@
- 111643951038723
+ 111643951038724

```

TransparentUpgradeableProxy at `0xEd42a7D8559a463722Ca4beD50E0Cc05a386b0e1`[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.CROSS_CHAIN_CONTROLLER") with implementation CrossChainController at `0x0Bf5bbfaE7808D329e0Ba8277e0b746BbfDA68f1`
```diff
@@ _currentEnvelopeNonce @@
- 130
+ 131
@@ _currentTransactionNonce @@
- 130
+ 131
@@ `_forwardedTransactions` key `0x0f55bbe24c2393c80af11b3458e91ab16534e4fc0950160251c50df824eed352` @@
- false
+ true

@@ `_registeredEnvelopes` key `0x592f90fa17d4584f0e168d90a73b9402e050f9d662017b7388c7ba4ceb046cec` @@
- false
+ true

```


### Check: Reports all events emitted from the proposal :white_check_mark:

#### Info

- TransparentUpgradeableProxy at `0xEd42a7D8559a463722Ca4beD50E0Cc05a386b0e1`[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.CROSS_CHAIN_CONTROLLER") with implementation CrossChainController at `0x0Bf5bbfaE7808D329e0Ba8277e0b746BbfDA68f1`
  - `EnvelopeRegistered(envelopeId: 0x592f90fa17d4584f0e168d90a73b9402e050f9d662017b7388c7ba4ceb046cec, envelope: [object Object])`
  - `TransactionForwardingAttempted(transactionId: 0x0f55bbe24c2393c80af11b3458e91ab16534e4fc0950160251c50df824eed352, envelopeId: 0x592f90fa17d4584f0e168d90a73b9402e050f9d662017b7388c7ba4ceb046cec, encodedTransaction: 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000008200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000820000000000000000000000009aee0b04504cef83a65ac3f0e838d0593bcb2bc7000000000000000000000000dabad81af85554e9ae636395611c58f7ec1aaec50000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000, destinationChainId: 1, bridgeAdapter: 0x118dfd5418890c0332042ab05173db4a2c1d283c, destinationBridgeAdapter: 0x118dfd5418890c0332042ab05173db4a2c1d283c, adapterSuccessful: false, returnData: 0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000023437000000000000000000000000000000000000000000000000000000000000)`
- TransparentUpgradeableProxy at `0x9AEE0B04504CeF83A65AC3f0e838D0593BCb2BC7`[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.GOVERNANCE") with implementation Governance at `0x58BcB647C4beFf253B4B6996c62F737B783f2cDd`
  - `PayloadSent(proposalId: 8, payloadId: 48, payloadsController: 0xdabad81af85554e9ae636395611c58f7ec1aaec5, chainId: 1, payloadNumberOnProposal: 0, numberOfPayloadsOnProposal: 1)`
  - `ProposalExecuted(proposalId: 8)`

### Check: Check all touched contracts are verified on Etherscan :white_check_mark:

#### Info

- 0xd73a92be73efbfcf3854433a5fcbabf9c1316073: EOA (verification not applicable)
- 0x9aee0b04504cef83a65ac3f0e838d0593bcb2bc7: Contract (verified) (TransparentUpgradeableProxy) [:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.GOVERNANCE")
- 0x58bcb647c4beff253b4b6996c62f737b783f2cdd: Contract (verified) (Governance) 
- 0xa198fac58e02a5c5f8f7e877895d50cfa9ad1e04: Contract (verified) (GovernancePowerStrategy) [:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.GOVERNANCE_POWER_STRATEGY")
- 0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9: Contract (verified) (InitializableAdminUpgradeabilityProxy) [:ghost:](https://github.com/bgd-labs/aave-address-book "AaveV2Ethereum.ASSETS.AAVE.UNDERLYING, AaveV3Ethereum.ASSETS.AAVE.UNDERLYING")
- 0x5d4aa78b08bc7c530e21bf7447988b1be7991322: Contract (verified) (AaveTokenV3) 
- 0x4da27a545c0c5b758a6ba100e3a049001de870f5: Contract (verified) (InitializableAdminUpgradeabilityProxy) 
- 0x0fe58fe1caa69951dc924a8c222be19013b89476: Contract (verified) (StakedAaveV3) 
- 0xa700b4eb416be35b2911fd5dee80678ff64ff6c9: Contract (verified) (InitializableImmutableAdminUpgradeabilityProxy) [:ghost:](https://github.com/bgd-labs/aave-address-book "AaveV3Ethereum.ASSETS.AAVE.A_TOKEN")
- 0x366ae337897223aea70e3ebe1862219386f20593: Contract (verified) (ATokenWithDelegation) 
- 0xed42a7d8559a463722ca4bed50e0cc05a386b0e1: Contract (verified) (TransparentUpgradeableProxy) [:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.CROSS_CHAIN_CONTROLLER")
- 0x0bf5bbfae7808d329e0ba8277e0b746bbfda68f1: Contract (verified) (CrossChainController) 
- 0x118dfd5418890c0332042ab05173db4a2c1d283c: Contract (verified) (SameChainAdapter) 
- 0xdabad81af85554e9ae636395611c58f7ec1aaec5: Contract (verified) (TransparentUpgradeableProxy) [:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.PAYLOADS_CONTROLLER")
- 0x7222182cb9c5320587b5148bf03eee107ad64578: Contract (verified) (PayloadsController) 

### Check: Check all touched contracts do not contain selfdestruct :white_check_mark:

#### Warnings

- [0xd73a92be73efbfcf3854433a5fcbabf9c1316073](https://etherscan.io/address/0xd73a92be73efbfcf3854433a5fcbabf9c1316073): EOA (may have code later)
- [0x9aee0b04504cef83a65ac3f0e838d0593bcb2bc7](https://etherscan.io/address/0x9aee0b04504cef83a65ac3f0e838d0593bcb2bc7): Contract (with DELEGATECALL)[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.GOVERNANCE")
- [0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9](https://etherscan.io/address/0x7fc66500c84a76ad7e9c93437bfc5ac33e2ddae9): Contract (with DELEGATECALL)[:ghost:](https://github.com/bgd-labs/aave-address-book "AaveV2Ethereum.ASSETS.AAVE.UNDERLYING, AaveV3Ethereum.ASSETS.AAVE.UNDERLYING")
- [0x4da27a545c0c5b758a6ba100e3a049001de870f5](https://etherscan.io/address/0x4da27a545c0c5b758a6ba100e3a049001de870f5): Contract (with DELEGATECALL)
- [0x0fe58fe1caa69951dc924a8c222be19013b89476](https://etherscan.io/address/0x0fe58fe1caa69951dc924a8c222be19013b89476): Contract (with DELEGATECALL)
- [0xa700b4eb416be35b2911fd5dee80678ff64ff6c9](https://etherscan.io/address/0xa700b4eb416be35b2911fd5dee80678ff64ff6c9): Contract (with DELEGATECALL)[:ghost:](https://github.com/bgd-labs/aave-address-book "AaveV3Ethereum.ASSETS.AAVE.A_TOKEN")
- [0xed42a7d8559a463722ca4bed50e0cc05a386b0e1](https://etherscan.io/address/0xed42a7d8559a463722ca4bed50e0cc05a386b0e1): Contract (with DELEGATECALL)[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.CROSS_CHAIN_CONTROLLER")
- [0x0bf5bbfae7808d329e0ba8277e0b746bbfda68f1](https://etherscan.io/address/0x0bf5bbfae7808d329e0ba8277e0b746bbfda68f1): Contract (with DELEGATECALL)
- [0xdabad81af85554e9ae636395611c58f7ec1aaec5](https://etherscan.io/address/0xdabad81af85554e9ae636395611c58f7ec1aaec5): Contract (with DELEGATECALL)[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.PAYLOADS_CONTROLLER")

#### Info

- [0x58bcb647c4beff253b4b6996c62f737b783f2cdd](https://etherscan.io/address/0x58bcb647c4beff253b4b6996c62f737b783f2cdd): Contract (looks safe)
- [0xa198fac58e02a5c5f8f7e877895d50cfa9ad1e04](https://etherscan.io/address/0xa198fac58e02a5c5f8f7e877895d50cfa9ad1e04): Contract (looks safe)[:ghost:](https://github.com/bgd-labs/aave-address-book "GovernanceV3Ethereum.GOVERNANCE_POWER_STRATEGY")
- [0x5d4aa78b08bc7c530e21bf7447988b1be7991322](https://etherscan.io/address/0x5d4aa78b08bc7c530e21bf7447988b1be7991322): Contract (looks safe)
- [0x366ae337897223aea70e3ebe1862219386f20593](https://etherscan.io/address/0x366ae337897223aea70e3ebe1862219386f20593): Contract (looks safe)
- [0x118dfd5418890c0332042ab05173db4a2c1d283c](https://etherscan.io/address/0x118dfd5418890c0332042ab05173db4a2c1d283c): Contract (looks safe)
- [0x7222182cb9c5320587b5148bf03eee107ad64578](https://etherscan.io/address/0x7222182cb9c5320587b5148bf03eee107ad64578): Contract (looks safe)

